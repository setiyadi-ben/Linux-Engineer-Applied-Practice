#=== Check Installed WSL Distros================================================================================================================================================================================
wsl --list --verbose

#Unregister (Uninstall)
wsl --unregister Debian

# list available os
wsl -l -o
#list installed os
wsl -l

#=== install os==================================================================================================================================================================================================
wsl --install Debian

# Change repo if needed
sudo cp /etc/apt/sources.list /etc/apt/sources.list.backup && \
sudo tee /etc/apt/sources.list <<'EOF'
deb http://mirror.sg.gs/debian/ trixie main contrib non-free non-free-firmware
deb http://mirror.sg.gs/debian-security trixie-security main contrib non-free non-free-firmware
deb http://mirror.sg.gs/debian/ trixie-updates main contrib non-free non-free-firmware
# Optional (paket versi baru)
deb http://mirror.sg.gs/debian/ trixie-backports main contrib non-free non-free-firmware
EOF
sudo apt update


sudo apt-get update && apt-get install net-tools ssh -y
sudo apt-get install curl wget -y

htop
df -h
ifstat
iftop

# ganti user dari root ke steam
sudo chown -R steam:steam "/path/to/folder"

# opening root access inside wsl
sudo su
sudo passwd root
#sudo grep root /etc/shadow

#=== install openssh-server======================================================================================================================================================================================
apt-get update && apt install net-tools ssh curl wget -y
# modify ssh to allow root login
nano /etc/ssh/sshd_config
# change the following
```
PermitRootLogin yes
PubkeyAuthentication yes
PasswordAuthentication yes
UsePAM yes
```
#check the ssh service
systemctl restart sshd
systemctl status sshd

# === Single line scripts (install openssh server)===============================================================================================================================================================
sudo su -c '
set -e
echo "[1/5] Setting root password..."
passwd root

echo "[2/5] Installing OpenSSH & tools..."
apt-get update -y && apt-get install -y net-tools ssh curl wget

echo "[3/5] Updating SSH configuration..."
CONFIG=/etc/ssh/sshd_config
cp -n $CONFIG ${CONFIG}.bak
sed -i "s/^#*PermitRootLogin.*/PermitRootLogin yes/" $CONFIG
sed -i "s/^#*PubkeyAuthentication.*/PubkeyAuthentication yes/" $CONFIG
sed -i "s/^#*PasswordAuthentication.*/PasswordAuthentication yes/" $CONFIG
sed -i "s/^#*UsePAM.*/UsePAM yes/" $CONFIG
grep -q "^PermitRootLogin" $CONFIG || echo "PermitRootLogin yes" >> $CONFIG
grep -q "^PubkeyAuthentication" $CONFIG || echo "PubkeyAuthentication yes" >> $CONFIG
grep -q "^PasswordAuthentication" $CONFIG || echo "PasswordAuthentication yes" >> $CONFIG
grep -q "^UsePAM" $CONFIG || echo "UsePAM yes" >> $CONFIG

echo "[4/5] Restarting SSH service..."
if command -v systemctl >/dev/null 2>&1; then
    systemctl restart ssh || true
    systemctl restart sshd || true
else
    service ssh restart || service sshd restart || true
fi

echo "[5/5] Checking SSH status..."
(ps -ef | grep ssh[d] && echo "[OK] SSH daemon running.") || echo "[WARN] SSH not running."

echo "All done! You can now SSH into root using password authentication."
'
#================================================================================================================================================================================================================

#=== "Tasksel Linux" Desktop Environment Selection=============================================================================================================================================================================================
sudo bash -c 'cd / && apt-get update -y && apt-get install tasksel -y && tasksel'

#===Debian Desktop Environment Summary | per 21:35/12-11-2025 ======================================================================================================================================================
1. GNOME    | Broken on WSL since not full instalation
2. Xfce     | Work but audio not working and have to deactivate WSLg ===> set  [wsl2]
                                                                               guiApplications=false in ===>  C:\Users\BENNYJRX for example
                                                                               
3. GNOME Flashback | Not yet tested
4. KDE Plasma      | Worked guiApplications=true in ===>  C:\Users\BENNYJRX for example
4. Cinnamon        | Worked guiApplications=true in ===>  C:\Users\BENNYJRX for example
5. MATE            | Not yet tested
6. LXDE            | Not yet tested
7. lxqt            | Broken

#=== Install xRDP===============================================================================================================================================================================================
sudo apt install -y lsb-release && \
curl -fsSL https://raw.githubusercontent.com/setiyadi-ben/Linux-Engineer-Applied-Practice/refs/heads/main/vm/xrdp-installer-1.5.5.sh | bash && \
echo "Menjalankan reboot..." && sudo reboot

#=== If audio not getting passthrough (Xfce problem)=============================================================================================================================================================
sudo apt install -y pipewire pipewire-pulse wireplumber && \
systemctl --user --now enable pipewire pipewire-pulse wireplumber && \
systemctl --user mask pulseaudio.socket pulseaudio.service && sudo reboot

# If the Desktop Environment Broken, or Audio PipeWire Audio Error==============================================================================================================================================
sudo bash -c 'DIR=$(pwd); [[ $DIR == /home/* ]] && rm -rf "$DIR"/* "$DIR"/.[!.]* "$DIR"/..?* && systemctl reboot'

# List Desktop Environment
ls /usr/share/xsessions/
# Select Desktop Environment
sudo update-alternatives --config x-session-manager

# Delete Desktop Environment
sudo apt purge \
  lxqt* mate* openbox* plasma* lightdm* kde* gnome* xfce4* cinnamon* budgie* \
  sugar* unity* enlightenment* lxde* tasksel xrdp pipewire-module-xrdp \
  pipewire pipewire-pulse pulseaudio wireplumber libcanberra* \
  xdg-desktop-portal* -y && \
sudo apt autoremove --purge -y && \
sudo apt autoclean && \
sudo rm -rf /usr/share/xsessions/*.desktop \
  /etc/xrdp /usr/lib/xrdp /usr/share/xrdp \
  /usr/share/wayland-sessions /usr/share/sddm/* /usr/share/gdm/*
#================================================================================================================================================================================================================

